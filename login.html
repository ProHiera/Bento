<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë¡œê·¸ì¸ - Bento</title>
    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="assets/css/components.css" />
  </head>
  <body>
    <!-- í—¤ë” -->
    <header class="header">
      <nav class="nav">
        <div class="container">
          <a href="index.html" class="logo">
            <img
              src="SlimBentoLogo.png"
              width="40"
              height="40"
              alt="Bento ë¡œê³ "
            />
            Bento
          </a>
          <ul class="nav-menu">
            <li><a href="index.html" class="nav-link">í™ˆ</a></li>
            <li><a href="index.html#menu" class="nav-link">ë©”ë‰´</a></li>
            <li><a href="index.html#builder" class="nav-link">ì»¤ìŠ¤í…€</a></li>
            <li>
              <a href="cart.html" class="nav-link"
                >ğŸ›’ ì¥ë°”êµ¬ë‹ˆ <span class="cart-count">0</span></a
              >
            </li>
          </ul>
          <div class="user-menu">
            <a href="login.html" class="nav-link active" id="login-link"
              >ë¡œê·¸ì¸</a
            >
            <a
              href="mypage.html"
              class="nav-link"
              id="mypage-link"
              style="display: none"
              >ë§ˆì´í˜ì´ì§€</a
            >
            <button id="logout-btn" class="logout-btn" style="display: none">
              ë¡œê·¸ì•„ì›ƒ
            </button>
          </div>
          <div class="menu-toggle">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </nav>
    </header>

    <main class="main-content">
      <div class="container">
        <div class="auth-container">
          <div class="auth-card">
            <div class="auth-header">
              <h1>ë¡œê·¸ì¸</h1>
              <p>Bentoì—ì„œ ë§›ìˆëŠ” ë„ì‹œë½ì„ ì£¼ë¬¸í•˜ì„¸ìš”</p>
            </div>

            <!-- ë¡œê·¸ì¸ í¼ -->
            <form id="login-form" class="auth-form">
              <div class="form-group">
                <label for="email">ì´ë©”ì¼</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
                />
              </div>

              <div class="form-group">
                <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                <input
                  type="password"
                  id="password"
                  name="password"
                  required
                  placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                />
              </div>

              <button type="submit" class="btn btn-primary btn-full">
                ë¡œê·¸ì¸
              </button>
            </form>

            <!-- íšŒì›ê°€ì… ë§í¬ -->
            <div class="auth-links">
              <p>
                ì•„ì§ íšŒì›ì´ ì•„ë‹ˆì‹ ê°€ìš”?
                <a href="#" id="show-register">íšŒì›ê°€ì…</a>
              </p>
            </div>

            <!-- í…ŒìŠ¤íŠ¸ ê³„ì • ì•ˆë‚´ -->
            <div class="test-account-info">
              <h4>í…ŒìŠ¤íŠ¸ ê³„ì •</h4>
              <p><strong>ì´ë©”ì¼:</strong> test@bento.com</p>
              <p><strong>ë¹„ë°€ë²ˆí˜¸:</strong> test123</p>
              <button
                type="button"
                id="fill-test-account"
                class="btn btn-secondary"
              >
                í…ŒìŠ¤íŠ¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
              </button>
            </div>
          </div>

          <!-- íšŒì›ê°€ì… í¼ (ìˆ¨ê¹€) -->
          <div class="auth-card" id="register-card" style="display: none">
            <div class="auth-header">
              <h1>íšŒì›ê°€ì…</h1>
              <p>Bentoì— ê°€ì…í•˜ê³  íŠ¹ë³„í•œ í˜œíƒì„ ë°›ì•„ë³´ì„¸ìš”</p>
            </div>

            <form id="register-form" class="auth-form">
              <div class="form-group">
                <label for="reg-name">ì´ë¦„</label>
                <input
                  type="text"
                  id="reg-name"
                  name="name"
                  required
                  placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”"
                />
              </div>

              <div class="form-group">
                <label for="reg-email">ì´ë©”ì¼</label>
                <input
                  type="email"
                  id="reg-email"
                  name="email"
                  required
                  placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"
                />
              </div>

              <div class="form-group">
                <label for="reg-password">ë¹„ë°€ë²ˆí˜¸</label>
                <input
                  type="password"
                  id="reg-password"
                  name="password"
                  required
                  placeholder="ë¹„ë°€ë²ˆí˜¸ (6ì ì´ìƒ)"
                />
              </div>

              <div class="form-group">
                <label for="reg-password-confirm">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input
                  type="password"
                  id="reg-password-confirm"
                  name="passwordConfirm"
                  required
                  placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”"
                />
              </div>

              <div class="form-group">
                <label for="reg-phone">ì „í™”ë²ˆí˜¸</label>
                <input
                  type="tel"
                  id="reg-phone"
                  name="phone"
                  required
                  placeholder="ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                />
              </div>

              <div class="form-group">
                <label for="reg-address">ì£¼ì†Œ</label>
                <input
                  type="text"
                  id="reg-address"
                  name="address"
                  placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)"
                />
              </div>

              <button type="submit" class="btn btn-primary btn-full">
                íšŒì›ê°€ì…
              </button>
            </form>

            <div class="auth-links">
              <p>ì´ë¯¸ íšŒì›ì´ì‹ ê°€ìš”? <a href="#" id="show-login">ë¡œê·¸ì¸</a></p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-logo">
            <h3>Bento</h3>
            <p>ê±´ê°•í•œ ë„ì‹œë½, ë§ì¶¤ ì£¼ë¬¸</p>
          </div>
          <div class="footer-links">
            <a href="index.html">í™ˆ</a>
            <a href="index.html#menu">ë©”ë‰´</a>
            <a href="index.html#builder">ì»¤ìŠ¤í…€</a>
            <a href="cart.html">ì¥ë°”êµ¬ë‹ˆ</a>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2025 Bento. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- JavaScript -->
    <script src="assets/js/auth.js"></script>
    <script>
      // ë¡œê·¸ì¸ í¼ ì²˜ë¦¬
      document
        .getElementById("login-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const email = document.getElementById("email").value;
          const password = document.getElementById("password").value;

          const result = window.authManager.login(email, password);

          if (result.success) {
            alert(`í™˜ì˜í•©ë‹ˆë‹¤, ${result.user.name}ë‹˜!`);
            window.location.href = "index.html";
          } else {
            alert(result.message);
          }
        });

      // íšŒì›ê°€ì… í¼ ì²˜ë¦¬
      document
        .getElementById("register-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = new FormData(e.target);
          const userData = Object.fromEntries(formData);

          // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
          if (userData.password !== userData.passwordConfirm) {
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return;
          }

          if (userData.password.length < 6) {
            alert("ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
            return;
          }

          delete userData.passwordConfirm;

          const result = window.authManager.register(userData);

          if (result.success) {
            alert(result.message + " ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");
            showLoginForm();
          } else {
            alert(result.message);
          }
        });

      // í¼ ì „í™˜
      function showRegisterForm() {
        document.querySelector(".auth-card:first-child").style.display = "none";
        document.getElementById("register-card").style.display = "block";
      }

      function showLoginForm() {
        document.querySelector(".auth-card:first-child").style.display =
          "block";
        document.getElementById("register-card").style.display = "none";
      }

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document
        .getElementById("show-register")
        .addEventListener("click", function (e) {
          e.preventDefault();
          showRegisterForm();
        });

      document
        .getElementById("show-login")
        .addEventListener("click", function (e) {
          e.preventDefault();
          showLoginForm();
        });

      // í…ŒìŠ¤íŠ¸ ê³„ì • ìë™ ì…ë ¥
      document
        .getElementById("fill-test-account")
        .addEventListener("click", function () {
          document.getElementById("email").value = "test@bento.com";
          document.getElementById("password").value = "test123";
        });

      // í˜ì´ì§€ ë¡œë“œ ì‹œ í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„±
      document.addEventListener("DOMContentLoaded", function () {
        const users = JSON.parse(localStorage.getItem("users")) || [];
        const testUser = users.find((u) => u.email === "test@bento.com");

        if (!testUser) {
          users.push({
            id: "test-user",
            name: "í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì",
            email: "test@bento.com",
            password: "test123",
            phone: "010-1234-5678",
            address: "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…ŒìŠ¤íŠ¸ë™ 123-45",
            joinDate: new Date().toISOString(),
          });
          localStorage.setItem("users", JSON.stringify(users));
        }
      });
    </script>
  </body>
</html>
